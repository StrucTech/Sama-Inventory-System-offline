#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Ø£Ø¯Ø§Ø© ØªØ­Ù„ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Activity Log - Ø¥ØµØ¯Ø§Ø± Ù…Ø¨Ø³Ø·
"""

import re
from datetime import datetime

# Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ù„Ù„ØªØ­Ù„ÙŠÙ„ (Ù†Ø³Ø®Ø© Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙŠ Ø£Ø±Ø³Ù„ØªÙ‡Ø§)
SAMPLE_DATA = [
    ["2025-10-21 20:09:04", "Ø¥Ù†Ø´Ø§Ø¡", "Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù†Ø¸Ø§Ù…", "1", "Ø§Ù„Ù…Ø¯ÙŠØ±", "ØªÙ… Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù†Ø¸Ø§Ù… ÙˆØ¥Ø¶Ø§ÙØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠØ©"],
    ["2025-10-21 20:09:04", "Ø¥Ø¶Ø§ÙØ©", "Ø£Ø¬Ù‡Ø²Ø© ÙƒÙ…Ø¨ÙŠÙˆØªØ± Ù…Ø­Ù…ÙˆÙ„Ø©", "25", "", "Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¯ÙØ¹Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ Ù…Ù† Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ±"],
    ["2025-10-21 20:09:04", "Ø¥Ø¶Ø§ÙØ©", "Ø®ÙˆØ§Ø¯Ù… Ø§Ù„Ø´Ø¨ÙƒØ©", "5", "", "Ø¥Ø¶Ø§ÙØ© Ø®ÙˆØ§Ø¯Ù… Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù„Ù…Ø´Ø±ÙˆØ¹"],
    ["2025-10-21 20:10:11", "Ø¥Ø¶Ø§ÙØ©", "Ø¹Ù†ØµØ± ØªØ¬Ø±ÙŠØ¨ÙŠ - PRJ_006", "50", "", "Ø¥Ø¶Ø§ÙØ© Ø¹Ù†ØµØ± Ø¬Ø¯ÙŠØ¯ Ø¨ÙƒÙ…ÙŠØ© 50 Ù„Ù„Ù…Ø´Ø±ÙˆØ¹ PRJ_006"],
    ["2025-10-21 20:12:14", "Ø¥Ø¶Ø§ÙØ©", "test", "10", "", "Ø¥Ø¶Ø§ÙØ© Ø¹Ù†ØµØ± Ø¬Ø¯ÙŠØ¯ Ø¨ÙƒÙ…ÙŠØ© 10 Ù„Ù„Ù…Ø´Ø±ÙˆØ¹ PRJ_001"],
    ["2025-10-21 21:47:09", "Ø¥Ø¶Ø§ÙØ©", "test", "11", "", "Ø¥Ø¶Ø§ÙØ© Ø¹Ù†ØµØ± Ø¬Ø¯ÙŠØ¯ Ø¨ÙƒÙ…ÙŠØ© 11"],
    ["2025-10-21 21:47:32", "Ø­Ø°Ù", "test", "80", "", "Ø­Ø°Ù Ø§Ù„Ø¹Ù†ØµØ± - Ø§Ù„ÙƒÙ…ÙŠØ© ÙƒØ§Ù†Øª: testtt"],
    ["2025-10-21 21:49:03", "Ø¥Ø¶Ø§ÙØ©", "Ù…Ø³Ø§Ù…ÙŠØ± Ø§Ø®ØªØ¨Ø§Ø±", "100", "", "Ø¥Ø¶Ø§ÙØ© Ø¹Ù†ØµØ± Ø¬Ø¯ÙŠØ¯ Ø¨ÙƒÙ…ÙŠØ© 100 Ù„Ù„Ù…Ø´Ø±ÙˆØ¹ TEST001"],
    ["2025-10-22 21:39:46", "Ø¥Ø¶Ø§ÙØ©", "Ù…Ø³Ø§Ù…ÙŠØ± Ø­Ø¯ÙŠØ¯ 5 Ø³Ù…", "150", "", "Ø¥Ø¶Ø§ÙØ© Ø¹Ù†ØµØ± Ø¬Ø¯ÙŠØ¯ Ø¨ÙƒÙ…ÙŠØ© 150 Ù„Ù„Ù…Ø´Ø±ÙˆØ¹ PROJ001"],
    ["2025-10-22 21:39:49", "Ø¥Ø¶Ø§ÙØ©", "Ø£Ø³Ù…Ù†Øª Ø±Ù…Ø§Ø¯ÙŠ", "30", "", "Ø¥Ø¶Ø§ÙØ© Ø¹Ù†ØµØ± Ø¬Ø¯ÙŠØ¯ Ø¨ÙƒÙ…ÙŠØ© 30 Ù„Ù„Ù…Ø´Ø±ÙˆØ¹ PROJ002"],
    ["2025-10-22 21:39:51", "Ø¥Ø¶Ø§ÙØ©", "ÙƒØ§Ø¨Ù„ ÙƒÙ‡Ø±Ø¨Ø§Ø¡ 4 Ù…Ù…", "80", "", "Ø¥Ø¶Ø§ÙØ© Ø¹Ù†ØµØ± Ø¬Ø¯ÙŠØ¯ Ø¨ÙƒÙ…ÙŠØ© 80 Ù„Ù„Ù…Ø´Ø±ÙˆØ¹ PROJ001"],
    ["2025-10-22 21:39:52", "Ø¥Ø¶Ø§ÙØ©", "Ø·Ù„Ø§Ø¡ Ø£Ø²Ø±Ù‚", "12", "", "Ø¥Ø¶Ø§ÙØ© Ø¹Ù†ØµØ± Ø¬Ø¯ÙŠØ¯ Ø¨ÙƒÙ…ÙŠØ© 12 Ù„Ù„Ù…Ø´Ø±ÙˆØ¹ PROJ003"],
    ["2025-10-22 21:39:54", "Ø¥Ø¶Ø§ÙØ©", "Ø¨Ø±Ø§ØºÙŠ Ù…Ø¹Ø¯Ù†ÙŠØ©", "250", "", "Ø¥Ø¶Ø§ÙØ© Ø¹Ù†ØµØ± Ø¬Ø¯ÙŠØ¯ Ø¨ÙƒÙ…ÙŠØ© 250 Ù„Ù„Ù…Ø´Ø±ÙˆØ¹ PROJ002"],
    ["2025-10-23 21:50:51", "Ø¥Ø¶Ø§ÙØ©", "Ù…Ø³Ø§Ù…ÙŠØ± Ø­Ø¯ÙŠØ¯ 5 Ø³Ù…", "8", "", "Ø¥Ø¶Ø§ÙØ© Ø¹Ù†ØµØ± Ø¬Ø¯ÙŠØ¯ Ø¨ÙƒÙ…ÙŠØ© 8"],
    ["2025-10-23 21:57:23", "Ø¥Ø¶Ø§ÙØ©", "Ù…Ø³Ø§Ù…ÙŠØ± Ø­Ø¯ÙŠØ¯ 5 Ø³Ù…", "10", "", "Ø¥Ø¶Ø§ÙØ© Ø¹Ù†ØµØ± Ø¬Ø¯ÙŠØ¯ Ø¨ÙƒÙ…ÙŠØ© 10 Ù„Ù„Ù…Ø´Ø±ÙˆØ¹ PRJ_001"],
    ["2025-10-28 20:26:29", "Ø¥Ø¶Ø§ÙØ©", "Ù…Ø³Ø§Ù…ÙŠØ± Ø­Ø¯ÙŠØ¯ 5 Ø³Ù…", "0", "", "Ø¥Ø¶Ø§ÙØ© Ø¹Ù†ØµØ± Ø¬Ø¯ÙŠØ¯ Ø¨ÙƒÙ…ÙŠØ© 0"],
    ["2025-10-30 17:23:01", "ØªØ­Ø¯ÙŠØ«", "Ù…Ø³Ø§Ù…ÙŠØ± Ø­Ø¯ÙŠØ¯ 5 Ø³Ù…", "159.0", "150.0", "ØªØ­Ø¯ÙŠØ« ÙƒÙ…ÙŠØ© Ø§Ù„Ø¹Ù†ØµØ± Ù…Ù† 150.0 Ø¥Ù„Ù‰ 159.0 (Ø¥Ø¶Ø§ÙØ© 9) Ù„Ù„Ù…Ø´Ø±ÙˆØ¹ PRJ_001"],
    ["2025-10-30 17:23:35", "ØªØ­Ø¯ÙŠØ«", "Ù…Ø³Ø§Ù…ÙŠØ± Ø­Ø¯ÙŠØ¯ 5 Ø³Ù…", "162.0", "159.0", "ØªØ­Ø¯ÙŠØ« ÙƒÙ…ÙŠØ© Ø§Ù„Ø¹Ù†ØµØ± Ù…Ù† 159.0 Ø¥Ù„Ù‰ 162.0 (Ø¥Ø¶Ø§ÙØ© 3) Ù„Ù„Ù…Ø´Ø±ÙˆØ¹ PRJ_001"],
    ["2025-10-30 17:39:09", "Ø¥Ø®Ø±Ø§Ø¬", "Ù…Ø³Ø§Ù…ÙŠØ± Ø­Ø¯ÙŠØ¯ 5 Ø³Ù…", "62", "ahmed", "Ø¥Ø®Ø±Ø§Ø¬ Ø¨Ø¶Ø§Ø¹Ø© - Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…Ø®Ø±Ø¬Ø©: 62, Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©: 100.0"],
    ["2025-11-02 18:40:50", "ØªØ­Ø¯ÙŠØ«", "Ø·Ù„Ø§Ø¡ Ø£Ø²Ø±Ù‚", "67.0", "12.0", "ØªØ­Ø¯ÙŠØ« ÙƒÙ…ÙŠØ© Ø§Ù„Ø¹Ù†ØµØ± Ù…Ù† 12.0 Ø¥Ù„Ù‰ 67.0 (Ø¥Ø¶Ø§ÙØ© 55) Ù„Ù„Ù…Ø´Ø±ÙˆØ¹ PRJ_001"]
]

def analyze_current_structure():
    """ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø­Ø§Ù„ÙŠ"""
    print("ğŸ” ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø­Ø§Ù„ÙŠ Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª")
    print("=" * 50)
    
    # Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
    current_headers = ["Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙˆÙ‚Øª", "Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©", "Ø§Ø³Ù… Ø§Ù„Ø¹Ù†ØµØ±", "Ø§Ù„ÙƒÙ…ÙŠØ©", "Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªÙ„Ù…", "Ø§Ù„ØªÙØ§ØµÙŠÙ„"]
    
    print("ğŸ“‹ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©:")
    for i, header in enumerate(current_headers, 1):
        print(f"   {i}. {header}")
    
    # ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    operation_types = set()
    item_names = set()
    recipients = set()
    projects = set()
    
    for record in SAMPLE_DATA:
        if len(record) >= 6:
            operation_types.add(record[1])
            item_names.add(record[2])
            if record[4]:
                recipients.add(record[4])
            
            # Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹
            details = record[5]
            project_matches = re.findall(r'(PRJ_\w+|PROJ\w*\d+|TEST\w*\d+)', details)
            projects.update(project_matches)
    
    print(f"\nğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:")
    print(f"   ğŸ“ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ø¬Ù„Ø§Øª: {len(SAMPLE_DATA)}")
    print(f"   âš™ï¸ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª: {sorted(operation_types)}")
    print(f"   ğŸ“¦ Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø®ØªÙ„ÙØ©: {len(item_names)}")
    print(f"   ğŸ‘¥ Ø§Ù„Ù…Ø³ØªÙ„Ù…ÙŠÙ†: {sorted(recipients) if recipients else ['Ù„Ø§ ÙŠÙˆØ¬Ø¯']}")
    print(f"   ğŸ—ï¸ Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹: {sorted(projects)}")

def propose_new_structure():
    """Ø§Ù‚ØªØ±Ø§Ø­ Ø§Ù„Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø¬Ø¯ÙŠØ¯"""
    print("\nğŸ—ï¸ Ø§Ù„Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ø§Ù„Ù…Ù‚ØªØ±Ø­")
    print("=" * 50)
    
    new_headers = [
        "Ø§Ù„ØªØ§Ø±ÙŠØ®",           # 1
        "Ø§Ù„ÙˆÙ‚Øª",             # 2
        "Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©",       # 3
        "Ø§Ø³Ù… Ø§Ù„Ø¹Ù†ØµØ±",        # 4
        "Ø§Ù„ØªØµÙ†ÙŠÙ",          # 5
        "Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…Ø¶Ø§ÙØ©",     # 6
        "Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…Ø®Ø±Ø¬Ø©",     # 7
        "Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©",     # 8
        "Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ©",     # 9
        "Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªÙ„Ù…",       # 10
        "Ø±Ù‚Ù… Ø§Ù„Ù…Ø´Ø±ÙˆØ¹",       # 11
        "Ø§Ù„ØªÙØ§ØµÙŠÙ„"          # 12
    ]
    
    print("ğŸ“‹ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©:")
    for i, header in enumerate(new_headers, 1):
        print(f"   {i:2d}. {header}")
    
    return new_headers

def convert_sample_record(old_record):
    """ØªØ­ÙˆÙŠÙ„ Ø³Ø¬Ù„ ÙˆØ§Ø­Ø¯ ÙƒÙ…Ø«Ø§Ù„"""
    if len(old_record) < 6:
        return None
    
    date_time = old_record[0]
    operation = old_record[1]
    item_name = old_record[2]
    quantity = old_record[3]
    recipient = old_record[4]
    details = old_record[5]
    
    # ØªÙÙƒÙŠÙƒ Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙˆÙ‚Øª
    date_part, time_part = "", ""
    if ' ' in date_time:
        date_part, time_part = date_time.split(' ', 1)
    
    # ØªØ­Ù„ÙŠÙ„ Ø§Ù„ÙƒÙ…ÙŠØ© Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©
    quantity_added = 0
    quantity_removed = 0
    previous_quantity = 0
    current_quantity = 0
    
    try:
        if operation == "Ø¥Ø¶Ø§ÙØ©" or operation == "Ø¥Ù†Ø´Ø§Ø¡":
            quantity_added = float(quantity)
            current_quantity = quantity_added
        elif operation == "Ø¥Ø®Ø±Ø§Ø¬":
            quantity_removed = float(quantity)
            # Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©
            remaining_match = re.search(r'Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©[:\s]*([0-9.]+)', details)
            if remaining_match:
                current_quantity = float(remaining_match.group(1))
                previous_quantity = current_quantity + quantity_removed
        elif operation == "ØªØ­Ø¯ÙŠØ«":
            # ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ø¯ÙŠØ«ØŒ Ø§Ù„ÙƒÙ…ÙŠØ© ÙÙŠ Ø§Ù„Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø«Ø§Ù„Ø« Ù‡ÙŠ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
            current_quantity = float(quantity)
            # ÙˆØ§Ù„ÙƒÙ…ÙŠØ© ÙÙŠ Ø§Ù„Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø±Ø§Ø¨Ø¹ Ù‡ÙŠ Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© (Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙˆØ¬ÙˆØ¯Ø©)
            if len(old_record) > 4 and old_record[4]:
                try:
                    previous_quantity = float(old_record[4])
                except ValueError:
                    # Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ø±Ù‚Ù…ØŒ Ù†Ø­Ø§ÙˆÙ„ Ù…Ù† Ø§Ù„ØªÙØ§ØµÙŠÙ„
                    from_match = re.search(r'Ù…Ù†\s+([0-9.]+)', details)
                    if from_match:
                        previous_quantity = float(from_match.group(1))
            
            if current_quantity > previous_quantity:
                quantity_added = current_quantity - previous_quantity
            else:
                quantity_removed = previous_quantity - current_quantity
        elif operation == "Ø­Ø°Ù":
            quantity_removed = float(quantity)
            current_quantity = 0
    except ValueError:
        pass
    
    # Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø±Ù‚Ù… Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
    project_number = ""
    project_match = re.search(r'(PRJ_\w+|PROJ\w*\d+|TEST\w*\d+)', details)
    if project_match:
        project_number = project_match.group(1)
    
    # ØªÙ†Ø¸ÙŠÙ Ø§Ù„ØªÙØ§ØµÙŠÙ„
    clean_details = details
    clean_details = re.sub(r'Ù„Ù„Ù…Ø´Ø±ÙˆØ¹\s+\w+', '', clean_details)
    clean_details = re.sub(r'PRJ_\w+|PROJ\w*\d+|TEST\w*\d+', '', clean_details)
    clean_details = re.sub(r'Ø¨ÙƒÙ…ÙŠØ©\s+[0-9.]+', '', clean_details)
    clean_details = clean_details.strip()
    
    # ØªØ®Ù…ÙŠÙ† Ø§Ù„ØªØµÙ†ÙŠÙ (ÙŠÙ…ÙƒÙ† ØªØ­Ø³ÙŠÙ†Ù‡ Ù„Ø§Ø­Ù‚Ø§Ù‹)
    category = ""
    if "Ù…Ø³Ø§Ù…ÙŠØ±" in item_name or "Ø¨Ø±Ø§ØºÙŠ" in item_name:
        category = "Ø£Ø¯ÙˆØ§Øª Ù…Ø¹Ø¯Ù†ÙŠØ©"
    elif "Ø£Ø³Ù…Ù†Øª" in item_name:
        category = "Ù…ÙˆØ§Ø¯ Ø§Ù„Ø¨Ù†Ø§Ø¡"
    elif "ÙƒØ§Ø¨Ù„" in item_name:
        category = "Ø£Ø¯ÙˆØ§Øª ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©"
    elif "Ø·Ù„Ø§Ø¡" in item_name:
        category = "Ù…ÙˆØ§Ø¯ Ø§Ù„ØªØ´Ø·ÙŠØ¨"
    elif "ÙƒÙ…Ø¨ÙŠÙˆØªØ±" in item_name or "Ø®ÙˆØ§Ø¯Ù…" in item_name:
        category = "Ø£Ø¬Ù‡Ø²Ø© ØªÙ‚Ù†ÙŠØ©"
    
    new_record = [
        date_part,
        time_part,
        operation,
        item_name,
        category,
        quantity_added,
        quantity_removed,
        previous_quantity,
        current_quantity,
        recipient,
        project_number,
        clean_details
    ]
    
    return new_record

def demonstrate_conversion():
    """Ø¹Ø±Ø¶ Ø£Ù…Ø«Ù„Ø© Ø¹Ù„Ù‰ Ø§Ù„ØªØ­ÙˆÙŠÙ„"""
    print("\nğŸ”„ Ø£Ù…Ø«Ù„Ø© Ø¹Ù„Ù‰ Ø§Ù„ØªØ­ÙˆÙŠÙ„")
    print("=" * 50)
    
    # Ø§Ø®ØªÙŠØ§Ø± Ø¨Ø¹Ø¶ Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù…ØªÙ†ÙˆØ¹Ø©
    test_records = [
        SAMPLE_DATA[8],   # Ø¥Ø¶Ø§ÙØ© Ù…Ø³Ø§Ù…ÙŠØ±
        SAMPLE_DATA[17],  # Ø¥Ø®Ø±Ø§Ø¬ Ù…Ø³Ø§Ù…ÙŠØ±  
        SAMPLE_DATA[16],  # ØªØ­Ø¯ÙŠØ« Ù…Ø³Ø§Ù…ÙŠØ±
        SAMPLE_DATA[6]    # Ø­Ø°Ù Ø¹Ù†ØµØ±
    ]
    
    new_headers = [
        "Ø§Ù„ØªØ§Ø±ÙŠØ®", "Ø§Ù„ÙˆÙ‚Øª", "Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©", "Ø§Ø³Ù… Ø§Ù„Ø¹Ù†ØµØ±", "Ø§Ù„ØªØµÙ†ÙŠÙ",
        "Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…Ø¶Ø§ÙØ©", "Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…Ø®Ø±Ø¬Ø©", "Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©", "Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ©",
        "Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªÙ„Ù…", "Ø±Ù‚Ù… Ø§Ù„Ù…Ø´Ø±ÙˆØ¹", "Ø§Ù„ØªÙØ§ØµÙŠÙ„"
    ]
    
    for i, record in enumerate(test_records, 1):
        print(f"\n--- Ù…Ø«Ø§Ù„ {i} ---")
        print("ğŸ“¥ Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„Ø£ØµÙ„ÙŠ:")
        current_headers = ["Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙˆÙ‚Øª", "Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©", "Ø§Ø³Ù… Ø§Ù„Ø¹Ù†ØµØ±", "Ø§Ù„ÙƒÙ…ÙŠØ©", "Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªÙ„Ù…", "Ø§Ù„ØªÙØ§ØµÙŠÙ„"]
        for j, (header, value) in enumerate(zip(current_headers, record)):
            print(f"   {header}: {value}")
        
        converted = convert_sample_record(record)
        if converted:
            print("\nğŸ“¤ Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„Ù…Ø­ÙˆÙ„:")
            for header, value in zip(new_headers, converted):
                if value or value == 0:  # Ø¹Ø±Ø¶ Ø§Ù„Ù‚ÙŠÙ… ØºÙŠØ± Ø§Ù„ÙØ§Ø±ØºØ© ÙˆØ§Ù„Ø£ØµÙØ§Ø±
                    print(f"   {header}: {value}")

def show_benefits():
    """Ø¹Ø±Ø¶ ÙÙˆØ§Ø¦Ø¯ Ø§Ù„Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø¬Ø¯ÙŠØ¯"""
    print("\nâœ… ÙÙˆØ§Ø¦Ø¯ Ø§Ù„Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø¬Ø¯ÙŠØ¯")
    print("=" * 50)
    
    benefits = [
        "ğŸ¯ ÙÙ„ØªØ±Ø© Ø¯Ù‚ÙŠÙ‚Ø© Ø¨Ø§Ù„ØªØ§Ø±ÙŠØ® (Ø¨Ø¯ÙˆÙ† Ø§Ù„Ø­Ø§Ø¬Ø© Ù„ÙØµÙ„ Ø§Ù„ØªØ§Ø±ÙŠØ® Ù…Ù† Ø§Ù„ÙˆÙ‚Øª)",
        "ğŸ“Š Ø­Ø³Ø§Ø¨ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ÙƒÙ…ÙŠØ§Øª Ø§Ù„Ù…Ø¶Ø§ÙØ© ÙˆØ§Ù„Ù…Ø®Ø±Ø¬Ø© Ø¨Ø³Ù‡ÙˆÙ„Ø©",
        "ğŸ” Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø±Ù‚Ù… Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ù…Ø¨Ø§Ø´Ø±Ø©",
        "ğŸ“ˆ ØªØªØ¨Ø¹ ØªØ·ÙˆØ± ÙƒÙ…ÙŠØ© ÙƒÙ„ Ø¹Ù†ØµØ± Ø¹Ø¨Ø± Ø§Ù„Ø²Ù…Ù†",
        "âš¡ Ø§Ø³ØªØ¹Ù„Ø§Ù…Ø§Øª Ø£Ø³Ø±Ø¹ ÙˆØ£ÙƒØ«Ø± Ø¯Ù‚Ø©",
        "ğŸ“‹ ØªÙ‚Ø§Ø±ÙŠØ± Ø£ÙƒØ«Ø± ØªÙØµÙŠÙ„Ø§Ù‹",
        "ğŸ·ï¸ ØªØµÙ†ÙŠÙ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„ÙÙ„Ø§ØªØ±",
        "ğŸ§¹ ØªÙØ§ØµÙŠÙ„ Ø£Ù†Ø¸Ù Ø¨Ø¯ÙˆÙ† ØªÙƒØ±Ø§Ø± Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª"
    ]
    
    for benefit in benefits:
        print(f"   {benefit}")

def main():
    """ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„ÙƒØ§Ù…Ù„"""
    print("ğŸ—ï¸ Ø£Ø¯Ø§Ø© ØªØ­Ù„ÙŠÙ„ ÙˆØ¥Ø¹Ø§Ø¯Ø© Ù‡ÙŠÙƒÙ„Ø© Activity Log")
    print("=" * 60)
    
    analyze_current_structure()
    propose_new_structure()
    demonstrate_conversion()
    show_benefits()
    
    print(f"\nğŸ¯ Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„ØªØ§Ù„ÙŠØ©:")
    print(f"   Ù‡Ø°Ø§ Ø§Ù„ØªØ­Ù„ÙŠÙ„ ÙŠÙˆØ¶Ø­ Ø§Ù„ÙÙˆØ§Ø¦Ø¯ Ø§Ù„Ù…Ø­ØªÙ…Ù„Ø© Ù„Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù‡ÙŠÙƒÙ„Ø©")
    print(f"   Ø¥Ø°Ø§ ÙƒÙ†Øª Ù…ÙˆØ§ÙÙ‚ØŒ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø£Ø¯Ø§Ø© Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„ÙØ¹Ù„ÙŠØ©")
    print(f"   ÙˆØ§Ù„ØªÙŠ Ø³ØªÙ‚ÙˆÙ… Ø¨ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© Ù…Ù† Google Sheets")

if __name__ == "__main__":
    main()