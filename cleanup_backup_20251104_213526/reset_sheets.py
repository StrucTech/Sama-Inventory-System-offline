"""
ุณูุฑูุจุช ููุณุญ ูุฅุนุงุฏุฉ ุชููุฆุฉ ุฌุฏุงูู ุฌูุฌู ุดูุช
ูููู ุจุญุฐู ุฌููุน ุงูุจูุงูุงุช ูุฅุนุงุฏุฉ ุฅูุดุงุก ุงูุดูุชุงุช ูู ุงูุจุฏุงูุฉ
"""

from sheets.manager import SheetsManager
from config.settings import load_config

def main():
    print("๐งน ูุณุญ ูุฅุนุงุฏุฉ ุชููุฆุฉ ุฌุฏุงูู ุฌูุฌู ุดูุช...")
    print("=" * 50)
    
    config = load_config()
    manager = SheetsManager(
        credentials_file=config["credentials_file"],
        spreadsheet_name=config["spreadsheet_name"],
        worksheet_name=config["worksheet_name"]
    )
    
    if manager.connect():
        print(f"โ ูุชุตู ุจุงูุฌุฏูู: '{config['spreadsheet_name']}'")
        
        try:
            # ูุณุญ ุดูุช ุงููุฎุฒูู
            if manager.worksheet:
                print("\n๐๏ธ ูุณุญ ุจูุงูุงุช ุดูุช ุงููุฎุฒูู...")
                
                # ูุณุญ ุฌููุน ุงูุจูุงูุงุช ูู ุงูุดูุช
                manager.worksheet.clear()
                
                # ุฅุนุงุฏุฉ ุฅูุดุงุก ุงูุนูุงููู
                manager._setup_headers()
                print("โ ุชู ูุณุญ ุดูุช ุงููุฎุฒูู ูุฅุนุงุฏุฉ ุฅูุดุงุก ุงูุนูุงููู")
            
            # ูุณุญ ุดูุช ุณุฌู ุงูุฃูุดุทุฉ
            if manager.activity_log:
                print("\n๐๏ธ ูุณุญ ุจูุงูุงุช ุดูุช ุณุฌู ุงูุฃูุดุทุฉ...")
                
                # ูุณุญ ุฌููุน ุงูุจูุงูุงุช ูู ุณุฌู ุงูุฃูุดุทุฉ
                manager.activity_log.clear()
                
                # ุฅุนุงุฏุฉ ุฅูุดุงุก ุงูุนูุงููู
                manager._setup_activity_log_headers()
                print("โ ุชู ูุณุญ ุดูุช ุณุฌู ุงูุฃูุดุทุฉ ูุฅุนุงุฏุฉ ุฅูุดุงุก ุงูุนูุงููู")
            
            print("\n๐ ุชู ูุณุญ ูุฅุนุงุฏุฉ ุชููุฆุฉ ุฌููุน ุงูุดูุชุงุช ุจูุฌุงุญ!")
            print("\nุงูุดูุชุงุช ุงููุญุฏุซุฉ:")
            print(f"๐ ุดูุช ุงููุฎุฒูู: {manager.worksheet.title}")
            print(f"๐ ุดูุช ุณุฌู ุงูุฃูุดุทุฉ: {manager.activity_log.title}")
            
            # ุนุฑุถ ุงูุฑุงุจุท ุงููุจุงุดุฑ
            spreadsheet_id = manager.spreadsheet.id
            spreadsheet_url = f"https://docs.google.com/spreadsheets/d/{spreadsheet_id}"
            print(f"\n๐ ุฑุงุจุท ุงูุฌุฏูู: {spreadsheet_url}")
            
            # ุงูุชุญูู ูู ุงูุดูุชุงุช
            print("\n๐ ุงูุชุญูู ูู ุงูุดูุชุงุช:")
            
            # ุนุฑุถ ุงููุฎุฒูู (ูุฌุจ ุฃู ูููู ูุงุฑุบ)
            items = manager.get_all_items()
            print(f"๐ฆ ุนุฏุฏ ุงูุนูุงุตุฑ ูู ุงููุฎุฒูู: {len(items)}")
            
            # ุนุฑุถ ุณุฌู ุงูุฃูุดุทุฉ (ูุฌุจ ุฃู ูููู ูุงุฑุบ)
            if manager.activity_log:
                activities = manager.activity_log.get_all_values()
                print(f"๐ ุนุฏุฏ ุงูุฃูุดุทุฉ ูู ุงูุณุฌู: {len(activities) - 1}")  # -1 ููุนูุงููู
            
            print("\nโ ุชู ุงูุชุญุฏูุซ ุจูุฌุงุญ! ููููู ุงูุขู ุจุฏุก ุงุณุชุฎุฏุงู ุงููุธุงู ูู ุฌุฏูุฏ.")
            
        except Exception as e:
            print(f"โ ุฎุทุฃ ูู ูุณุญ ุงูุจูุงูุงุช: {e}")
            
    else:
        print("โ ูุดู ูู ุงูุงุชุตุงู ุจุฌุฏุงูู ุฌูุฌู")

if __name__ == "__main__":
    # ุชุฃููุฏ ูู ุงููุณุชุฎุฏู
    print("โ๏ธ  ุชุญุฐูุฑ: ูุฐุง ุงูุณูุฑูุจุช ุณูููู ุจุญุฐู ุฌููุน ุงูุจูุงูุงุช ูู ุฌุฏุงูู ุฌูุฌู!")
    print("๐๏ธ  ุณูุชู ุญุฐู:")
    print("   - ุฌููุน ุนูุงุตุฑ ุงููุฎุฒูู")
    print("   - ุฌููุน ุณุฌูุงุช ุงูุฃูุดุทุฉ")
    print("   - ุฌููุน ุงูุจูุงูุงุช ุงูููุฌูุฏุฉ")
    
    confirm = input("\nโ ูู ุฃูุช ูุชุฃูุฏ ูู ุงููุชุงุจุนุฉุ ุงูุชุจ 'ูุนู' ูููุชุงุจุนุฉ: ")
    
    if confirm.strip().lower() in ['ูุนู', 'yes', 'y']:
        main()
    else:
        print("โ ุชู ุฅูุบุงุก ุงูุนูููุฉ")