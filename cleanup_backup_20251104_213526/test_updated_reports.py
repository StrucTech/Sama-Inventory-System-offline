#!/usr/bin/env python3
"""
ุงุฎุชุจุงุฑ ูุงูุฐุฉ ุงูุชูุงุฑูุฑ ุงููุญุฏุซุฉ ูุน ุงูุนูุงููุฏ ุงูุฌุฏูุฏุฉ
"""

import tkinter as tk
from tkinter import ttk
import sys
import os

# ุฅุถุงูุฉ ูุณุงุฑ ุงููุดุฑูุน
sys.path.append(os.path.dirname(__file__))

# ูุญุงููุฉ ุงุณุชูุฑุงุฏ ูุงูุฐุฉ ุงูุชูุงุฑูุฑ
try:
    from gui.reports_window import ReportsAnalysisWindow
    print("โ ุชู ุงุณุชูุฑุงุฏ ReportsAnalysisWindow ุจูุฌุงุญ")
except ImportError as e:
    print(f"โ ูุดู ูู ุงุณุชูุฑุงุฏ ReportsAnalysisWindow: {e}")
    # ุงููุญุงููุฉ ูุน ูุณุงุฑ ูุฎุชูู
    try:
        from gui.reports_window import ReportsWindow
        print("โ ุชู ุงุณุชูุฑุงุฏ ReportsWindow ุจูุฌุงุญ")
    except ImportError as e2:
        print(f"โ ูุดู ูู ุงุณุชูุฑุงุฏ ReportsWindow ุฃูุถุงู: {e2}")
        exit(1)

# ูุญุงูู ููุฏูุฑ ุงูุดูุชุงุช
class MockSheetsManager:
    def get_all_items_raw(self):
        """ุฅุฑุฌุงุน ุจูุงูุงุช ููููุฉ ูููุฎุฒูู"""
        return [
            ["ุณูููุช", "ููุงุฏ ุจูุงุก", "50", "P001", "2024-01-15"],
            ["ุญุฏูุฏ", "ููุงุฏ ุจูุงุก", "30", "P002", "2024-01-20"],
            ["ุทูุงุก", "ุฏูุงูุงุช", "20", "P001", "2024-01-25"],
            ["ุฑูู", "ููุงุฏ ุจูุงุก", "100", "P003", "2024-01-30"],
        ]
    
    def get_activity_log(self):
        """ุฅุฑุฌุงุน ุณุฌู ูุดุงุท ูููู"""
        return [
            ["2024-01-10", "ุฅุถุงูุฉ", "ุณูููุช", "100", "", "ุฅุถุงูุฉ ูููุดุฑูุน P001"],
            ["2024-01-12", "ุฅุฎุฑุงุฌ", "ุณูููุช", "25", "ูุญูุฏ", "ุฅุฎุฑุงุฌ ูููุดุฑูุน P001"],
            ["2024-01-15", "ุฅุถุงูุฉ", "ุญุฏูุฏ", "50", "", "ุฅุถุงูุฉ ูููุดุฑูุน P002"],
            ["2024-01-18", "ุฅุฎุฑุงุฌ", "ุญุฏูุฏ", "10", "ุฃุญูุฏ", "ุฅุฎุฑุงุฌ ูููุดุฑูุน P002"],
            ["2024-01-20", "ุฅุถุงูุฉ", "ุทูุงุก", "30", "", "ุฅุถุงูุฉ ูููุดุฑูุน P001"],
            ["2024-01-22", "ุฅุฎุฑุงุฌ", "ุทูุงุก", "5", "ุนูู", "ุฅุฎุฑุงุฌ ูููุดุฑูุน P001"],
            ["2024-01-25", "ุฅุถุงูุฉ", "ุฑูู", "200", "", "ุฅุถุงูุฉ ูููุดุฑูุน P003"],
            ["2024-01-28", "ุฅุฎุฑุงุฌ", "ุฑูู", "50", "ุณุงูู", "ุฅุฎุฑุงุฌ ูููุดุฑูุน P003"],
        ]

def test_updated_reports():
    """ุงุฎุชุจุงุฑ ูุงูุฐุฉ ุงูุชูุงุฑูุฑ ุงููุญุฏุซุฉ"""
    print("๐งช ุจุฏุก ุงุฎุชุจุงุฑ ูุงูุฐุฉ ุงูุชูุงุฑูุฑ ุงููุญุฏุซุฉ...")
    
    # ุฅูุดุงุก ุงููุงูุฐุฉ ุงูุฑุฆูุณูุฉ
    root = tk.Tk()
    root.title("ุงุฎุชุจุงุฑ ูุงูุฐุฉ ุงูุชูุงุฑูุฑ ุงููุญุฏุซุฉ")
    root.geometry("800x600")
    
    # ุฅูุดุงุก ูุฏูุฑ ุดูุชุงุช ูููู
    mock_sheets = MockSheetsManager()
    
    # ุฅูุดุงุก ูุงูุฐุฉ ุงูุชูุงุฑูุฑ
    try:
        if 'ReportsAnalysisWindow' in globals():
            reports = ReportsAnalysisWindow(root, mock_sheets)
        else:
            reports = ReportsWindow(root, mock_sheets)
        
        print("โ ุชู ุฅูุดุงุก ูุงูุฐุฉ ุงูุชูุงุฑูุฑ ุจูุฌุงุญ")
        print("๐ ุงูุนูุงููุฏ ุงููุชููุนุฉ: ุงูุนูุตุฑุ ุงูุฏุฎููุ ุชุงุฑูุฎ ุงูุฏุฎููุ ุงูุฎุฑูุฌุ ุชุงุฑูุฎ ุงูุฎุฑูุฌุ ุงููุดุฑูุน")
        print("๐ ุงูุฅุญุตุงุฆูุงุช ุงููุชููุนุฉ: ูุฌููุน ุงูุฏุฎููุ ูุฌููุน ุงูุฎุฑูุฌุ ุงููุชุจูู")
        
        # ุชุนูููุงุช ูููุณุชุฎุฏู
        print("\n๐ ุชุนูููุงุช ุงูุงุฎุชุจุงุฑ:")
        print("1. ุชุญูู ูู ูุฌูุฏ ุงูุนูุงููุฏ ุงูุฌุฏูุฏุฉ")
        print("2. ุชุญูู ูู ุนุฏู ูุฌูุฏ ููุชุฑ ุงูุชุตููู")
        print("3. ุชุญูู ูู ุนุฑุถ ุงูุจูุงูุงุช ูู ุงูุนูุงููุฏ ุงูุตุญูุญุฉ")
        print("4. ุชุญูู ูู ุงูุฅุญุตุงุฆูุงุช ูู ุงูุฃุณูู")
        print("5. ุฌุฑุจ ุงูููุงุชุฑ ุงููุชุจููุฉ")
        
        # ุจุฏุก ุงูุชุทุจูู
        root.mainloop()
        
    except Exception as e:
        print(f"โ ุฎุทุฃ ูู ุฅูุดุงุก ูุงูุฐุฉ ุงูุชูุงุฑูุฑ: {e}")
        import traceback
        traceback.print_exc()
        root.destroy()

if __name__ == "__main__":
    test_updated_reports()