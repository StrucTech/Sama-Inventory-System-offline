#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
ุงุฎุชุจุงุฑ ูุงูุฐุฉ ุงูุชูุงุฑูุฑ ูุงูุชุญููู
"""

import sys
import os
sys.path.append(os.path.dirname(os.path.abspath(__file__)))

import tkinter as tk
from tkinter import ttk
from gui.reports_window import show_reports_window
from datetime import datetime, timedelta

class MockSheetsManager:
    """ูุญุงูู ูุฏูุฑ ุงูุดูุชุงุช ููุงุฎุชุจุงุฑ"""
    
    def __init__(self):
        pass
    
    def get_all_items(self):
        """ุฅุฑุฌุงุน ุจูุงูุงุช ููููุฉ ููุนูุงุตุฑ"""
        return [
            ["ุฃุณููุช", "ููุงุฏ ุจูุงุก", "100", "ูุดุฑูุน1", "2024-10-01 10:00:00"],
            ["ุญุฏูุฏ", "ููุงุฏ ุจูุงุก", "50", "ูุดุฑูุน1", "2024-10-02 11:00:00"],
            ["ุทูุจ", "ููุงุฏ ุจูุงุก", "200", "ูุดุฑูุน2", "2024-10-03 12:00:00"],
            ["ุฏูุงู", "ุชุดุทูุจุงุช", "30", "ูุดุฑูุน1", "2024-10-04 13:00:00"],
            ["ุจูุงุท", "ุชุดุทูุจุงุช", "75", "ูุดุฑูุน2", "2024-10-05 14:00:00"],
            ["ูุงุจู", "ููุฑุจุงุก", "120", "ูุดุฑูุน3", "2024-10-06 15:00:00"],
            ["ููุงุชูุญ", "ููุฑุจุงุก", "25", "ูุดุฑูุน1", "2024-10-07 16:00:00"],
        ]
    
    def get_activity_log(self):
        """ุฅุฑุฌุงุน ุณุฌู ูุดุงุท ูููู"""
        return [
            ["2024-10-01 10:00:00", "ุฅุถุงูุฉ", "ุฃุณููุช", "100", "", "ุฅุถุงูุฉ ุนูุตุฑ ุฌุฏูุฏ ุจูููุฉ 100 ูููุดุฑูุน ูุดุฑูุน1"],
            ["2024-10-02 11:00:00", "ุฅุถุงูุฉ", "ุญุฏูุฏ", "50", "", "ุฅุถุงูุฉ ุนูุตุฑ ุฌุฏูุฏ ุจูููุฉ 50 ูููุดุฑูุน ูุดุฑูุน1"],
            ["2024-10-03 09:00:00", "ุฎุฑูุฌ", "ุฃุณููุช", "20", "ุฃุญูุฏ ูุญูุฏ", "ุฅุฎุฑุงุฌ 20 ูู ุฃุณููุช ูุฃุญูุฏ ูุญูุฏ"],
            ["2024-10-03 12:00:00", "ุฅุถุงูุฉ", "ุทูุจ", "200", "", "ุฅุถุงูุฉ ุนูุตุฑ ุฌุฏูุฏ ุจูููุฉ 200 ูููุดุฑูุน ูุดุฑูุน2"],
            ["2024-10-04 13:00:00", "ุฅุถุงูุฉ", "ุฏูุงู", "30", "", "ุฅุถุงูุฉ ุนูุตุฑ ุฌุฏูุฏ ุจูููุฉ 30 ูููุดุฑูุน ูุดุฑูุน1"],
            ["2024-10-04 15:00:00", "ุฎุฑูุฌ", "ุญุฏูุฏ", "15", "ุณุงุฑุฉ ุฃุญูุฏ", "ุฅุฎุฑุงุฌ 15 ูู ุญุฏูุฏ ูุณุงุฑุฉ ุฃุญูุฏ"],
            ["2024-10-05 14:00:00", "ุฅุถุงูุฉ", "ุจูุงุท", "75", "", "ุฅุถุงูุฉ ุนูุตุฑ ุฌุฏูุฏ ุจูููุฉ 75 ูููุดุฑูุน ูุดุฑูุน2"],
            ["2024-10-05 16:00:00", "ุชุญุฏูุซ", "ุฃุณููุช", "120", "80", "ุชุญุฏูุซ ูููุฉ ุงูุนูุตุฑ ูู 80 ุฅูู 120 (ุฅุถุงูุฉ 40)"],
            ["2024-10-06 15:00:00", "ุฅุถุงูุฉ", "ูุงุจู", "120", "", "ุฅุถุงูุฉ ุนูุตุฑ ุฌุฏูุฏ ุจูููุฉ 120 ูููุดุฑูุน ูุดุฑูุน3"],
            ["2024-10-07 16:00:00", "ุฅุถุงูุฉ", "ููุงุชูุญ", "25", "", "ุฅุถุงูุฉ ุนูุตุฑ ุฌุฏูุฏ ุจูููุฉ 25 ูููุดุฑูุน ูุดุฑูุน1"],
            ["2024-10-08 10:00:00", "ุฎุฑูุฌ", "ุทูุจ", "50", "ูุญูุฏ ุนูู", "ุฅุฎุฑุงุฌ 50 ูู ุทูุจ ููุญูุฏ ุนูู"],
        ]

class MockUser:
    """ูุญุงูู ุจูุงูุงุช ุงููุณุชุฎุฏู"""
    
    def __init__(self):
        self.user_data = {
            'username': 'test_user',
            'user_type': 'admin',
            'project_id': 'ูุดุฑูุน1'
        }
    
    def get(self, key, default=None):
        return self.user_data.get(key, default)

def test_reports_window():
    """ุงุฎุชุจุงุฑ ูุงูุฐุฉ ุงูุชูุงุฑูุฑ"""
    print("๐ ุจุฏุก ุงุฎุชุจุงุฑ ูุงูุฐุฉ ุงูุชูุงุฑูุฑ ูุงูุชุญููู...")
    
    # ุฅูุดุงุก ุงููุงูุฐุฉ ุงูุฑุฆูุณูุฉ
    root = tk.Tk()
    root.title("ุงุฎุชุจุงุฑ ูุงูุฐุฉ ุงูุชูุงุฑูุฑ")
    root.geometry("300x200")
    
    # ูุฏูุฑ ุงูุดูุชุงุช ุงููููู
    mock_manager = MockSheetsManager()
    mock_user = MockUser()
    
    # ุฒุฑ ููุชุญ ูุงูุฐุฉ ุงูุชูุงุฑูุฑ
    def open_reports():
        print("๐ ูุชุญ ูุงูุฐุฉ ุงูุชูุงุฑูุฑ...")
        try:
            show_reports_window(root, mock_manager, mock_user)
        except Exception as e:
            print(f"โ ุฎุทุฃ: {e}")
            import traceback
            traceback.print_exc()
    
    # ุฅูุดุงุก ูุงุฌูุฉ ุงูุงุฎุชุจุงุฑ
    main_frame = ttk.Frame(root, padding="20")
    main_frame.pack(fill=tk.BOTH, expand=True)
    
    title_label = ttk.Label(main_frame, text="ุงุฎุชุจุงุฑ ูุงูุฐุฉ ุงูุชูุงุฑูุฑ", 
                           font=("Arial", 14, "bold"))
    title_label.pack(pady=(0, 20))
    
    open_btn = ttk.Button(main_frame, text="ูุชุญ ูุงูุฐุฉ ุงูุชูุงุฑูุฑ ูุงูุชุญููู", 
                         command=open_reports)
    open_btn.pack(pady=10)
    
    info_label = ttk.Label(main_frame, 
                          text="ุณุชูุชุญ ูุงูุฐุฉ ุชุญุชูู ุนูู:\nโข ููุงุชุฑ ุงูุชุงุฑูุฎ ูุงูุนูุงุตุฑ ูุงููุดุงุฑูุน\nโข ุฌุฏูู ุงููุชุงุฆุฌ\nโข ุงูุฅุญุตุงุฆูุงุช", 
                          justify=tk.CENTER)
    info_label.pack(pady=10)
    
    close_btn = ttk.Button(main_frame, text="ุฅุบูุงู", command=root.quit)
    close_btn.pack(pady=10)
    
    print("โ ุฌุงูุฒ ููุงุฎุชุจุงุฑ!")
    root.mainloop()

if __name__ == "__main__":
    test_reports_window()