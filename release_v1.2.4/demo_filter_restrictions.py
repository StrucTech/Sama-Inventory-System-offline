#!/usr/bin/env python3
"""
ุชุฌุฑุจุฉ ูุงุฌูุฉ ุงูููุงุชุฑ ูุน ูููุฏ ุงููุณุชุฎุฏู ุงูุนุงุฏู
"""

import sys
import os
sys.path.append(os.path.dirname(os.path.abspath(__file__)))

import tkinter as tk
from config.user_session import UserSession
from new_activity_filter_system import NewActivityFilterSystem

def create_sample_data():
    """ุฅูุดุงุก ุจูุงูุงุช ุชุฌุฑูุจูุฉ"""
    return [
        {
            'ุงูุชุงุฑูุฎ': '2024-01-15',
            'ุงูููุช': '10:30',
            'ููุน ุงูุนูููุฉ': 'ุฅุฏุฎุงู',
            'ุงุณู ุงูุนูุตุฑ': 'ูุณุงููุฑ ุญุฏูุฏ 10ูู',
            'ุงูุชุตููู': 'ููุงุฏ ุงูุจูุงุก',
            'ุงููููุฉ ุงููุถุงูุฉ': '100',
            'ุงููููุฉ ุงููุณุญูุจุฉ': '0',
            'ุงูุฑุตูุฏ': '100',
            'ุงุณู ุงููุณุชุฎุฏู': 'ุณุงุฑุฉ ูุญูุฏ',
            'ุฑูู ุงููุดุฑูุน': '102',
            'ุงูุชูุงุตูู': 'ุฅุถุงูุฉ ูุฎุฒูู ุฌุฏูุฏ'
        },
        {
            'ุงูุชุงุฑูุฎ': '2024-01-15',
            'ุงูููุช': '11:00',
            'ููุน ุงูุนูููุฉ': 'ุณุญุจ',
            'ุงุณู ุงูุนูุตุฑ': 'ุฃุณููุช ุฃุจูุถ 50ูุบ',
            'ุงูุชุตููู': 'ููุงุฏ ุงูุจูุงุก',
            'ุงููููุฉ ุงููุถุงูุฉ': '0',
            'ุงููููุฉ ุงููุณุญูุจุฉ': '5',
            'ุงูุฑุตูุฏ': '45',
            'ุงุณู ุงููุณุชุฎุฏู': 'ุฃุญูุฏ ุนูู',
            'ุฑูู ุงููุดุฑูุน': '103',
            'ุงูุชูุงุตูู': 'ุงุณุชุฎุฏุงู ูู ุงูุนูู'
        },
        {
            'ุงูุชุงุฑูุฎ': '2024-01-15',
            'ุงูููุช': '12:15',
            'ููุน ุงูุนูููุฉ': 'ุชุนุฏูู',
            'ุงุณู ุงูุนูุตุฑ': 'ูุซูุงุจ ููุฑุจุงุฆู',
            'ุงูุชุตููู': 'ุฃุฏูุงุช',
            'ุงููููุฉ ุงููุถุงูุฉ': '2',
            'ุงููููุฉ ุงููุณุญูุจุฉ': '0',
            'ุงูุฑุตูุฏ': '7',
            'ุงุณู ุงููุณุชุฎุฏู': 'ุณุงุฑุฉ ูุญูุฏ',
            'ุฑูู ุงููุดุฑูุน': '102',
            'ุงูุชูุงุตูู': 'ุชุตุญูุญ ุงููููุฉ - ุฅุถุงูุฉ 2'
        },
        {
            'ุงูุชุงุฑูุฎ': '2024-01-15',
            'ุงูููุช': '14:30',
            'ููุน ุงูุนูููุฉ': 'ุณุญุจ',
            'ุงุณู ุงูุนูุตุฑ': 'ุทูุงุก ุฃุจูุถ 4ูุชุฑ',
            'ุงูุชุตููู': 'ููุงุฏ ุงูุชุดุทูุจ',
            'ุงููููุฉ ุงููุถุงูุฉ': '0',
            'ุงููููุฉ ุงููุณุญูุจุฉ': '3',
            'ุงูุฑุตูุฏ': '12',
            'ุงุณู ุงููุณุชุฎุฏู': 'ูุญูุฏ ุญุณู',
            'ุฑูู ุงููุดุฑูุน': '101',
            'ุงูุชูุงุตูู': 'ููุงุณุชุฎุฏุงู ูู ุงูุทุงุจู ุงูุซุงูู'
        },
        {
            'ุงูุชุงุฑูุฎ': '2024-01-15',
            'ุงูููุช': '15:45',
            'ููุน ุงูุนูููุฉ': 'ุฅุฏุฎุงู',
            'ุงุณู ุงูุนูุตุฑ': 'ููุงุชูุญ ููุฑุจุงุฆูุฉ',
            'ุงูุชุตููู': 'ููุฑุจุงุฆูุงุช',
            'ุงููููุฉ ุงููุถุงูุฉ': '20',
            'ุงููููุฉ ุงููุณุญูุจุฉ': '0',
            'ุงูุฑุตูุฏ': '35',
            'ุงุณู ุงููุณุชุฎุฏู': 'ุณุงุฑุฉ ูุญูุฏ',
            'ุฑูู ุงููุดุฑูุน': '102',
            'ุงูุชูุงุตูู': 'ุดุญูุฉ ุฌุฏูุฏุฉ ูู ุงูููุฑุฏ'
        }
    ]

def test_regular_user_interface():
    """ุชุฌุฑุจุฉ ูุงุฌูุฉ ุงููุณุชุฎุฏู ุงูุนุงุฏู"""
    print("๐ด ุงุฎุชุจุงุฑ ูุงุฌูุฉ ุงููุณุชุฎุฏู ุงูุนุงุฏู...")
    
    # ุฅูุดุงุก ุฌูุณุฉ ูุณุชุฎุฏู ุนุงุฏู
    user_session = UserSession()
    user_session.login("ุณุงุฑุฉ ูุญูุฏ", 102, is_admin=False)
    
    # ุฅูุดุงุก ุงููุงูุฐุฉ ุงูุฑุฆูุณูุฉ
    root = tk.Tk()
    root.title("ุงุฎุชุจุงุฑ ูููุฏ ุงูููุงุชุฑ - ูุณุชุฎุฏู ุนุงุฏู")
    root.geometry("800x600")
    
    try:
        # ุฅูุดุงุก ูุธุงู ุงูููุงุชุฑ
        filter_system = NewActivityFilterSystem(
            parent=root, 
            sheets_manager=None,  # ูู ูุญุชุงุฌ ูุงุชุตุงู ูุนูู
            current_user=user_session.username
        )
        
        # ุชุนููู ุฌูุณุฉ ุงููุณุชุฎุฏู
        filter_system.user_session = user_session
        
        # ุชุญููู ุงูุจูุงูุงุช ุงูุชุฌุฑูุจูุฉ
        filter_system.all_operations = create_sample_data()
        
        # ุชุทุจูู ุงูููุงุชุฑ ูุนุฑุถ ุงูุจูุงูุงุช ุงูููุงุณุจุฉ
        filter_system.apply_filters()
        
        # ุฅุธูุงุฑ ูุนูููุงุช ุนู ุงูููุงุชุฑ
        info_text = f"""
ูููุฏ ุงููุณุชุฎุฏู ุงูุนุงุฏู:
โข ุงุณู ุงููุณุชุฎุฏู: {user_session.username}
โข ุฑูู ุงููุดุฑูุน: {user_session.project_number}
โข ููุน ุงููุณุชุฎุฏู: ูุณุชุฎุฏู ุนุงุฏู

ุงูููุงุชุฑ ุงููููุฏุฉ:
โข ููุชุฑ ุงููุณุชุฎุฏู: ูููุฏ ุนูู '{user_session.username}'
โข ููุชุฑ ุงููุดุฑูุน: ูููุฏ ุนูู '{user_session.project_number}'

ุงูููุงุชุฑ ุงููุงุจูุฉ ููุชุนุฏูู:
โข ููุชุฑ ุงูุชุตููู: ูููู ุชุบููุฑู
โข ููุชุฑ ุงูุนูุตุฑ: ูููู ุชุบููุฑู

ุณูุชู ุนุฑุถ {len(filter_system.displayed_operations)} ุนูููุฉ ููุท ูู ุฃุตู {len(filter_system.all_operations)} ุนูููุฉ
        """
        
        # ุฅุถุงูุฉ ูุต ุชูุถูุญู
        info_label = tk.Label(
            root, 
            text=info_text, 
            justify=tk.LEFT, 
            bg="lightblue", 
            font=("Arial", 9)
        )
        info_label.pack(fill=tk.X, padx=10, pady=5)
        
        print(f"โ ุชู ุฅูุดุงุก ุงููุงุฌูุฉ")
        print(f"๐ ุงูุจูุงูุงุช ุงููุนุฑูุถุฉ: {len(filter_system.displayed_operations)} ูู ุฃุตู {len(filter_system.all_operations)}")
        
        # ุชุดุบูู ุงููุงูุฐุฉ
        print("\n๐ฅ๏ธ ุงูุชุญ ุงููุงูุฐุฉ ูุฑุคูุฉ ุงููุงุฌูุฉ ูุน ุงููููุฏ ุงููุทุจูุฉ")
        print("   โข ููุงุชุฑ ุงููุณุชุฎุฏู ูุงููุดุฑูุน ุณุชุธูุฑ ูุนุทูุฉ")
        print("   โข ููุงุชุฑ ุงูุชุตููู ูุงูุนูุตุฑ ุณุชุธูุฑ ูุงุจูุฉ ููุชุนุฏูู")
        print("   โข ุงูุจูุงูุงุช ุงููุนุฑูุถุฉ ุณุชููู ููุชุตุฑุฉ ุนูู ุงููุณุชุฎุฏู ูุงููุดุฑูุน ุงูุญุงูู")
        print("\nโ๏ธ ุงุถุบุท Ctrl+C ูู ุงููุญุทุฉ ูุฅุบูุงู ุงููุงูุฐุฉ")
        
        root.mainloop()
        
    except Exception as e:
        print(f"โ ุฎุทุฃ: {e}")
        root.destroy()
        raise

def test_admin_interface():
    """ุชุฌุฑุจุฉ ูุงุฌูุฉ ุงููุฏูุฑ"""
    print("\n๐ต ุงุฎุชุจุงุฑ ูุงุฌูุฉ ุงููุฏูุฑ...")
    
    # ุฅูุดุงุก ุฌูุณุฉ ูุฏูุฑ
    admin_session = UserSession()
    admin_session.login("Admin User", 999, is_admin=True)
    
    # ุฅูุดุงุก ุงููุงูุฐุฉ ุงูุฑุฆูุณูุฉ
    root = tk.Tk()
    root.title("ุงุฎุชุจุงุฑ ุงูููุงุชุฑ - ูุฏูุฑ")
    root.geometry("800x600")
    
    try:
        # ุฅูุดุงุก ูุธุงู ุงูููุงุชุฑ
        filter_system = NewActivityFilterSystem(
            parent=root, 
            sheets_manager=None,
            current_user=admin_session.username
        )
        
        # ุชุนููู ุฌูุณุฉ ุงููุณุชุฎุฏู
        filter_system.user_session = admin_session
        
        # ุชุญููู ุงูุจูุงูุงุช ุงูุชุฌุฑูุจูุฉ
        filter_system.all_operations = create_sample_data()
        
        # ุชุทุจูู ุงูููุงุชุฑ
        filter_system.apply_filters()
        
        # ุฅุธูุงุฑ ูุนูููุงุช ุนู ุงูููุงุชุฑ
        info_text = f"""
ุตูุงุญูุงุช ุงููุฏูุฑ:
โข ุงุณู ุงููุณุชุฎุฏู: {admin_session.username}
โข ุฑูู ุงููุดุฑูุน: {admin_session.project_number}
โข ููุน ุงููุณุชุฎุฏู: ูุฏูุฑ

ุฌููุน ุงูููุงุชุฑ ูุชุงุญุฉ:
โข ููุชุฑ ุงููุณุชุฎุฏู: ูููู ุชุบููุฑู ูุฃู ูุณุชุฎุฏู
โข ููุชุฑ ุงููุดุฑูุน: ูููู ุชุบููุฑู ูุฃู ูุดุฑูุน
โข ููุชุฑ ุงูุชุตููู: ูููู ุชุบููุฑู
โข ููุชุฑ ุงูุนูุตุฑ: ูููู ุชุบููุฑู

ุณูุชู ุนุฑุถ ุฌููุน ุงูุนูููุงุช: {len(filter_system.displayed_operations)}
        """
        
        # ุฅุถุงูุฉ ูุต ุชูุถูุญู
        info_label = tk.Label(
            root, 
            text=info_text, 
            justify=tk.LEFT, 
            bg="lightgreen", 
            font=("Arial", 9)
        )
        info_label.pack(fill=tk.X, padx=10, pady=5)
        
        print(f"โ ุชู ุฅูุดุงุก ูุงุฌูุฉ ุงููุฏูุฑ")
        print(f"๐ ุงูุจูุงูุงุช ุงููุนุฑูุถุฉ: {len(filter_system.displayed_operations)}")
        
        # ุชุดุบูู ุงููุงูุฐุฉ
        print("\n๐ฅ๏ธ ุงูุชุญ ุงููุงูุฐุฉ ูุฑุคูุฉ ูุงุฌูุฉ ุงููุฏูุฑ")
        print("   โข ุฌููุน ุงูููุงุชุฑ ุณุชุธูุฑ ูุงุจูุฉ ููุชุนุฏูู")
        print("   โข ุฌููุน ุงูุจูุงูุงุช ุณุชููู ูุฑุฆูุฉ")
        print("\nโ๏ธ ุงุถุบุท Ctrl+C ูู ุงููุญุทุฉ ูุฅุบูุงู ุงููุงูุฐุฉ")
        
        root.mainloop()
        
    except Exception as e:
        print(f"โ ุฎุทุฃ: {e}")
        root.destroy()
        raise

if __name__ == "__main__":
    print("๐งช ุชุฌุฑุจุฉ ูุงุฌูุฉ ุงูููุงุชุฑ ูุน ุงููููุฏ")
    print("=" * 50)
    
    choice = input("ุงุฎุชุฑ ููุน ุงููุณุชุฎุฏู ููุงุฎุชุจุงุฑ:\n1. ูุณุชุฎุฏู ุนุงุฏู (ูููุฏ ูุทุจูุฉ)\n2. ูุฏูุฑ (ุจุฏูู ูููุฏ)\nุงุฎุชุฑ (1 ุฃู 2): ")
    
    try:
        if choice == "1":
            test_regular_user_interface()
        elif choice == "2":
            test_admin_interface()
        else:
            print("โ ุงุฎุชูุงุฑ ุบูุฑ ุตุญูุญ")
            
    except KeyboardInterrupt:
        print("\n\n๐ ุชู ุฅุบูุงู ุงูุงุฎุชุจุงุฑ")
    except Exception as e:
        print(f"\nโ ุฎุทุฃ: {e}")
        import traceback
        traceback.print_exc()