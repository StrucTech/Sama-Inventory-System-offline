# ูุธุงู ุฃุฑูุงู ุงููุนุงููุงุช ูุงูุฑุจุท ุงููุฑุฌุนู

## ๐ฏ ุงููุฏู ูู ุงููุธุงู ุงูุฌุฏูุฏ

### **ุชุญุณูู ุชุชุจุน ุงููุนุงููุงุช ูุงูุชุนุฏููุงุช**
- ุฅุถุงูุฉ ุฑูู ูููุฒ ููู ูุนุงููุฉ (ุฏุฎูู/ุฎุฑูุฌ/ุชุนุฏูู)
- ุฑุจุท ูุนุงููุงุช ุงูุชุนุฏูู ุจุงููุนุงููุฉ ุงูุฃุตููุฉ ุนุจุฑ ุฑูู ูุฑุฌุนู
- ุชุณููู ุงูุชุชุจุน ูุงููุฑุงุฌุนุฉ ูุน ูุซุฑุฉ ุงููุนุงููุงุช ูุงูุชุนุฏููุงุช
- ุดูุงููุฉ ูุงููุฉ ูู ุชุงุฑูุฎ ุงููุนุงููุงุช

## โจ ุงูููุฒุงุช ุงูุฌุฏูุฏุฉ

### **1. ุฑูู ุงููุนุงููุฉ ุงููููุฒ**
- ูู ูุนุงููุฉ ุชุญุตู ุนูู ุฑูู ุชุณูุณูู ูุฑูุฏ
- ุงูุชุฑููู ุงูุชููุงุฆู ูุงููุชุณูุณู
- ุนุฏู ุชูุฑุงุฑ ุงูุฃุฑูุงู ุญุชู ูุน ุงูุญุฐู

### **2. ุงูุฑุจุท ุงููุฑุฌุนู ููุชุนุฏููุงุช**
- ูู ุชุนุฏูู ูุญุชูู ุนูู ุฑูู ุงููุนุงููุฉ ุงูุฃุตููุฉ
- ุฅููุงููุฉ ุชุชุจุน ุฌููุน ุงูุชุนุฏููุงุช ููุนุงููุฉ ูุนููุฉ
- ุณุฌู ูุงูู ููุชุบููุฑุงุช ูุงูุชุนุฏููุงุช

### **3. ุงูุชูุงูู ูุน ุงููููุงุช ุงููุฏููุฉ**
- ุฅุถุงูุฉ ุฃุฑูุงู ุชููุงุฆูุฉ ูููุนุงููุงุช ุงูููุฌูุฏุฉ
- ุนุฏู ุชุฃุซูุฑ ุนูู ุงูุจูุงูุงุช ุงูุณุงุจูุฉ
- ุชุฑููุฉ ุชุฏุฑูุฌูุฉ ูููุธุงู

## ๐๏ธ ุงูุชูุงุตูู ุงูุชูููุฉ

### **ุจููุฉ ุงูููู ุงูุฌุฏูุฏุฉ:**
```
ุฃุนูุฏุฉ ููู ุงููุนุงููุงุช:
โโโ ุฑูู_ุงููุนุงููุฉ (ุฌุฏูุฏ)
โโโ ุงููุดุฑูุน
โโโ ุงูุชุงุฑูุฎ
โโโ ุงุณู_ุงูุนูุตุฑ
โโโ ุงูุชุตููู
โโโ ููุน_ุงูุนูููุฉ
โโโ ุงููููุฉ
โโโ ุงุณู_ุงููุณุชูู
โโโ ูุฏุฉ_ุงูุตูุงุญูุฉ_ุจุงูุฃูุงู
โโโ ููุงุญุธุงุช
โโโ ุฑูู_ุงููุนุงููุฉ_ุงููุฑุฌุนูุฉ (ุฌุฏูุฏ)
```

### **ูุธุงุฆู ุงููุธุงู ุงูุฌุฏูุฏ:**

#### **1. ุชูููุฏ ุงูุฑูู ุงูุชุณูุณูู**
```python
def generate_transaction_id(self, project_name):
    """ุชูููุฏ ุฑูู ูุนุงููุฉ ูููุฒ"""
    try:
        project_file = os.path.join("projects", f"{project_name}_Transactions.xlsx")
        
        if os.path.exists(project_file):
            df = pd.read_excel(project_file, engine='openpyxl')
            
            # ุงูุชุญูู ูู ูุฌูุฏ ุนููุฏ ุฑูู ุงููุนุงููุฉ ูุงูุชูุงูู ูุน ุงููููุงุช ุงููุฏููุฉ
            if not df.empty and 'ุฑูู_ุงููุนุงููุฉ' in df.columns:
                # ุงูุญุตูู ุนูู ุฃุนูู ุฑูู ููุฌูุฏ
                max_id = df['ุฑูู_ุงููุนุงููุฉ'].max()
                return max_id + 1 if not pd.isna(max_id) else 1
            else:
                # ูููููุงุช ุงููุฏููุฉุ ูุจุฏุฃ ูู ุฑูู ุงูุตููู + 1
                return len(df) + 1 if not df.empty else 1
        else:
            return 1
            
    except Exception as e:
        # ูู ุญุงูุฉ ุงูุฎุทุฃุ ูุณุชุฎุฏู timestamp ูุฑูู ูููุฒ
        return int(datetime.now().timestamp())
```

#### **2. ุถูุงู ุงูุชูุงูู ูุน ุงููููุงุช ุงููุฏููุฉ**
```python
def ensure_columns_compatibility(self, df):
    """ุถูุงู ุชูุงูู ุงูุฃุนูุฏุฉ ูุน ุงููููุงุช ุงููุฏููุฉ"""
    required_columns = [
        'ุฑูู_ุงููุนุงููุฉ', 'ุงููุดุฑูุน', 'ุงูุชุงุฑูุฎ', 'ุงุณู_ุงูุนูุตุฑ', 'ุงูุชุตููู',
        'ููุน_ุงูุนูููุฉ', 'ุงููููุฉ', 'ุงุณู_ุงููุณุชูู', 'ูุฏุฉ_ุงูุตูุงุญูุฉ_ุจุงูุฃูุงู', 
        'ููุงุญุธุงุช', 'ุฑูู_ุงููุนุงููุฉ_ุงููุฑุฌุนูุฉ'
    ]
    
    # ุฅุถุงูุฉ ุงูุฃุนูุฏุฉ ุงูููููุฏุฉ
    for col in required_columns:
        if col not in df.columns:
            if col == 'ุฑูู_ุงููุนุงููุฉ':
                # ุฅุถุงูุฉ ุฃุฑูุงู ุชุณูุณููุฉ ูููุนุงููุงุช ุงูููุฌูุฏุฉ
                df[col] = range(1, len(df) + 1)
            elif col == 'ุฑูู_ุงููุนุงููุฉ_ุงููุฑุฌุนูุฉ':
                # ุงููููุฉ ุงูุงูุชุฑุงุถูุฉ ูููุนุงููุงุช ุงููุฏููุฉ
                df[col] = None
            else:
                df[col] = df.get(col, None)
    
    return df[required_columns]  # ุฅุนุงุฏุฉ ุชุฑุชูุจ ุงูุฃุนูุฏุฉ
```

#### **3. ุฑุจุท ุงูุชุนุฏููุงุช ุจุงููุนุงููุฉ ุงูุฃุตููุฉ**
```python
def add_adjustment_transaction(self, item_name, difference, original_transaction):
    """ุฅุถุงูุฉ ูุนุงููุฉ ุชุนุฏูู ุจุงููุฑู ููุท ูุน ุฑูู ูุฑุฌุนู"""
    try:
        if difference == 0:
            return  # ูุง ุญุงุฌุฉ ูุฅุถุงูุฉ ูุนุงููุฉ ุฅุฐุง ูู ููู ููุงู ุชุบููุฑ
        
        # ุงูุญุตูู ุนูู ุฑูู ุงููุนุงููุฉ ุงููุฑุฌุนูุฉ
        reference_id = None
        if 'ุฑูู_ุงููุนุงููุฉ' in original_transaction:
            reference_id = original_transaction['ุฑูู_ุงููุนุงููุฉ']
        
        # ุชุญุฏูุฏ ููุน ุงูุนูููุฉ ูุงููููุฉ ุญุณุจ ุงููุฑู
        if difference > 0:
            operation_type = 'ุชุนุฏูู ุฒูุงุฏุฉ'
            quantity = abs(difference)
        else:
            operation_type = 'ุชุนุฏูู ููุต'
            quantity = abs(difference)
        
        # ุฅุถุงูุฉ ูุนุงููุฉ ุงูุชุนุฏูู ูุน ุงูุฑูู ุงููุฑุฌุนู
        excel_manager.record_transaction(
            self.project_name,
            item_name,
            quantity,
            operation_type,
            f'ุชุนุฏูู ูููุฉ - {self.reason_combo.currentText()} (ูุฑุฌุน: {reference_id})',
            reference_id=reference_id
        )
        
    except Exception as e:
        raise Exception(f"ุฎุทุฃ ูู ุฅุถุงูุฉ ูุนุงููุฉ ุงูุชุนุฏูู: {str(e)}")
```

## ๐ ุฃูุซูุฉ ุนูููุฉ

### **ูุซุงู 1: ูุนุงููุฉ ุฃุตููุฉ**
```
ุฑูู ุงููุนุงููุฉ: 001
ููุน ุงูุนูููุฉ: ุฏุฎูู
ุงููููุฉ: 100
ุฑูู ุงููุนุงููุฉ ุงููุฑุฌุนูุฉ: -
```

### **ูุซุงู 2: ุชุนุฏูู ุฃูู**
```
ุฑูู ุงููุนุงููุฉ: 002
ููุน ุงูุนูููุฉ: ุชุนุฏูู ููุต
ุงููููุฉ: 50 (ุงููุฑู ูู 100 ุฅูู 50)
ุฑูู ุงููุนุงููุฉ ุงููุฑุฌุนูุฉ: 001
ุงูููุงุญุธุงุช: ุชุนุฏูู ูููุฉ - ุชุตุญูุญ ุฎุทุฃ ูู ุงูุฅุฏุฎุงู (ูุฑุฌุน: 001)
```

### **ูุซุงู 3: ุชุนุฏูู ุซุงูู**
```
ุฑูู ุงููุนุงููุฉ: 003
ููุน ุงูุนูููุฉ: ุชุนุฏูู ููุต
ุงููููุฉ: 5 (ุงููุฑู ูู 50 ุฅูู 45)
ุฑูู ุงููุนุงููุฉ ุงููุฑุฌุนูุฉ: 001
ุงูููุงุญุธุงุช: ุชุนุฏูู ูููุฉ - ุฅุนุงุฏุฉ ุนุฏ ุงููุฎุฒูู (ูุฑุฌุน: 001)
```

## ๐ฏ ููุงุฆุฏ ุงููุธุงู ุงูุฌุฏูุฏ

### **ูููุณุชุฎุฏู:**
- โ **ุชุชุจุน ุณูู**: ุฑูู ูุฑูุฏ ููู ูุนุงููุฉ
- โ **ุดูุงููุฉ ูุงููุฉ**: ูุนุฑูุฉ ูุตุฏุฑ ูู ุชุนุฏูู
- โ **ูุฑุงุฌุนุฉ ุฏูููุฉ**: ุชุชุจุน ุชุงุฑูุฎ ุงููุนุงููุฉ ูุงููุงู
- โ **ุชูุธูู ุฃูุถู**: ุฑุจุท ูุงุถุญ ุจูู ุงูุชุนุฏููุงุช ูุงูุฃุตู

### **ูููุธุงู:**
- โ **ูููุฉ ูุฑูุฏุฉ**: ูู ูุนุงููุฉ ููุง ุฑูู ูุง ูุชูุฑุฑ
- โ **ุฑุจุท ูุฑุฌุนู**: ุนูุงูุฉ ูุงุถุญุฉ ุจูู ุงูุชุนุฏููุงุช
- โ **ุชูุงูู ุนูุณู**: ูุนูู ูุน ุงููููุงุช ุงููุฏููุฉ
- โ **ูุฑููุฉ**: ูุงุจู ููุชุทููุฑ ูุงูุชูุณุน

## ๐ ูุงุฌูุฉ ุงููุณุชุฎุฏู ุงููุญุณูุฉ

### **ุฌุฏูู ุงููุนุงููุงุช ุงูุญุฏูุซุฉ:**
```
| ุฑูู ุงููุนุงููุฉ | ุงูุชุงุฑูุฎ | ุงูุนูุตุฑ | ุงูุชุตููู | ููุน ุงูุนูููุฉ | ุงููุฎุฒูู ุงูุญุงูู | ุงูููุช ุงููุชุจูู | ุญุงูุฉ ุงูุชุนุฏูู |
|-------------|---------|---------|----------|-------------|--------------|-------------|-------------|
| 001         | 2025... | ููุจููุชุฑ | ุฅููุชุฑูู  | ุฏุฎูู        | 45           | 18ุณ 30ุฏ     | ูุงุจู ููุชุนุฏูู |
```

### **ุนุฑุถ ุงูุชุนุฏููุงุช:**
ุนูุฏ ุนุฑุถ ุฌููุน ุงููุนุงููุงุชุ ุณุชุธูุฑ:
```
| ุฑูู ุงููุนุงููุฉ | ููุน ุงูุนูููุฉ | ุงููููุฉ | ุงููุฑุฌุน | ุงูููุงุญุธุงุช |
|-------------|-------------|--------|--------|----------|
| 001         | ุฏุฎูู        | 100    | -      | ูุนุงููุฉ ุฃุตููุฉ |
| 002         | ุชุนุฏูู ููุต   | 50     | 001    | ุชุนุฏูู ูููุฉ - ุชุตุญูุญ ุฎุทุฃ |
| 003         | ุชุนุฏูู ููุต   | 5      | 001    | ุชุนุฏูู ูููุฉ - ุฅุนุงุฏุฉ ุนุฏ |
```

## ๐ ุงููุณุชูุจู ูุงูุชุทููุฑ

### **ุฅููุงููุงุช ุฅุถุงููุฉ:**
- ุชูุงุฑูุฑ ููุตูุฉ ุญุณุจ ุฑูู ุงููุนุงููุฉ
- ุจุญุซ ูููุชุฑุฉ ุจุงูุฑูู ุงููุฑุฌุนู
- ุชุญูููุงุช ูุชูุฏูุฉ ููุชุนุฏููุงุช
- ุชุตุฏูุฑ ุจูุงูุงุช ูุฑุฌุนูุฉ

### **ููุงุฆุฏ ูุณุชูุจููุฉ:**
- ุณูููุฉ ุงูุตูุงูุฉ ูุงูุงุณุชูุดุงู
- ุฏูุฉ ุฃูุจุฑ ูู ุงููุฑุงุฌุนุฉ ูุงูุชุฏููู
- ุฅููุงููุฉ ุงูุชูุงูู ูุน ุฃูุธูุฉ ุฃุฎุฑู
- ูุงุนุฏุฉ ุจูุงูุงุช ููุธูุฉ ููุฑุฌุนูุฉ

## โก ุงูุฎูุงุตุฉ

ุงููุธุงู ุงูุฌุฏูุฏ ูููุฑ:
- **ูููุฉ ูุฑูุฏุฉ ููู ูุนุงููุฉ** ูุน ุฑูู ูุง ูุชูุฑุฑ
- **ุฑุจุท ูุงุถุญ ููุชุนุฏููุงุช** ุจุงููุนุงููุฉ ุงูุฃุตููุฉ
- **ุชูุงูู ูุงูู** ูุน ุงูุจูุงูุงุช ุงูููุฌูุฏุฉ
- **ุดูุงููุฉ ูุทููุฉ** ูู ุชุชุจุน ุงููุนุงููุงุช
- **ุณูููุฉ ุงููุฑุงุฌุนุฉ** ูุน ูุซุฑุฉ ุงูุจูุงูุงุช

ูุฐุง ุณูุฌุนู ุงููุธุงู ุฃูุซุฑ ููุฉ ููุถูุญุงู ูุน ููู ุญุฌู ุงูุจูุงูุงุช! ๐