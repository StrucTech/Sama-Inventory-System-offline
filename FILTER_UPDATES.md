# تحديثات النظام - فلتر التقارير بالتاريخ

## التحديثات المضافة:

### 1. حوار فلتر التقرير (`report_filter_dialog.py`)
- واجهة جديدة لاختيار نطاق التواريخ للتقرير
- إظهار معلومات التقرير السابق
- معاينة نطاق التقرير قبل التصدير
- تحديد تاريخ البداية والنهاية
- تصميم عربي كامل مع تخطيط من اليمين لليسار

### 2. التصدير المفلتر (`report_manager.py`)
وظيفة جديدة: `export_filtered_report_to_excel()`
- تصدير التقارير بناء على فترة زمنية محددة
- إنشاء عدة أوراق في Excel:
  - معلومات التقرير والفلتر
  - الحركات المفلترة
  - حركات الدخول المفلترة
  - حركات الخروج المفلترة
  - إحصائيات الفترة المحددة
  - العناصر المتأثرة
  - المخزون الحالي (مرجعي)

### 3. تحديث الواجهة الرئيسية (`main_window.py`)
- إزالة الأزرار غير المرغوب فيها:
  - زر طباعة التقرير
  - زر تحميل بيانات تجريبية
  - زر تبديل وضع النافذة
- تغيير اسم زر "تصدير Excel" إلى "تصدير تقرير للمكتب"
- ربط الزر الجديد بحوار فلتر التقرير

### 4. الميزات الجديدة:
- **فلتر بالتاريخ**: اختيار فترة زمنية محددة للتقرير
- **معلومات التقرير السابق**: عرض تواريخ ومعلومات آخر تقرير تم إنشاؤه
- **إحصائيات الفترة**: حساب إحصائيات مفصلة للفترة المحددة
- **العناصر المتأثرة**: ملخص العناصر التي تمت معالجتها في الفترة
- **معاينة نطاق التقرير**: إظهار عدد الأيام والفترة قبل التصدير

### 5. التحسينات:
- تخطيط عربي محسّن للواجهات
- رسائل تحذيرية عند اختيار تواريخ غير صحيحة
- تنسيق أفضل لملفات Excel
- إدارة محسّنة للأخطاء

### 6. كيفية الاستخدام:
1. افتح النظام واختر مشروعك
2. اضغط على "تصدير تقرير للمكتب"
3. ستظهر نافذة اختيار التواريخ
4. حدد التاريخ من والى
5. راجع معاينة نطاق التقرير
6. اضغط "تصدير التقرير"
7. سيتم حفظ التقرير في مجلد `reports`

### 7. مجلد التقارير:
- يتم إنشاء مجلد `reports` تلقائياً
- أسماء الملفات تحتوي على:
  - نوع التقرير (مفلتر/شامل)
  - اسم المشروع
  - تاريخ ووقت الإنشاء

## ملاحظات مهمة:
- النظام يحتفظ بمعلومات التقارير السابقة
- يمكن إنشاء تقارير لفترات مختلفة
- التقارير المفلترة تحتوي على معلومات شاملة
- جميع الواجهات تدعم اللغة العربية بالكامل